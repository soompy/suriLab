(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[358],{42465:(e,s,t)=>{Promise.resolve().then(t.bind(t,65896))},65896:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>O});var i=t(95155),l=t(12115),r=t(54581),n=t(67217),o=t(700),c=t(68534),a=t(9665),d=t(18407),h=t(73731),x=t(44296),j=t(17976),A=t(56033),u=t(90404),p=t(64263),m=t(99776),g=t(41101),b=t(71803),f=t(3127),y=t(24507),w=t(56278),k=t(54492),v=t(99927),C=t(71977),E=t(40857),S=t(58674),P=t(28890),z=t(52217),_=t(85089),W=t(19505),L=t(35695),N=t(69817),D=t(94615),F=t(6821);function O(){var e;let s=(0,L.useRouter)(),[t,O]=(0,l.useState)([]),[R,T]=(0,l.useState)(!0),[H,I]=(0,l.useState)(null),[U,J]=(0,l.useState)({open:!1,post:null}),[K,q]=(0,l.useState)(1),[B,G]=(0,l.useState)(1),[M,Q]=(0,l.useState)(""),V=async()=>{try{T(!0);let e=new URLSearchParams({page:K.toString(),limit:"10",isPublished:"",search:M}),s=await fetch("/api/posts?".concat(e.toString()));if(!s.ok)throw Error("Failed to fetch posts");let t=await s.json();O(t.posts),G(t.totalPages)}catch(e){I(e instanceof Error?e.message:"An error occurred")}finally{T(!1)}};(0,l.useEffect)(()=>{V()},[K,M]);let X=async e=>{try{if(!(await fetch("/api/posts/".concat(e.id),{method:"DELETE"})).ok)throw Error("Failed to delete post");await V(),J({open:!1,post:null}),alert("포스트가 삭제되었습니다.")}catch(e){console.error("Error deleting post:",e),alert("포스트 삭제에 실패했습니다.")}},Y=async e=>{try{if(!(await fetch("/api/posts/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPublished:!e.isPublished})})).ok)throw Error("Failed to update post");await V(),alert("포스트가 ".concat(e.isPublished?"비공개":"공개","되었습니다."))}catch(e){console.error("Error updating post:",e),alert("포스트 상태 변경에 실패했습니다.")}},Z=e=>{window.open("/posts/".concat(e.slug),"_blank")},$=e=>{s.push("/admin/posts/edit/".concat(e.id))},ee=e=>new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return R?(0,i.jsx)(N.A,{children:(0,i.jsxs)(r.A,{sx:{minHeight:"100vh",bgcolor:"background.default"},children:[(0,i.jsx)(D.A,{}),(0,i.jsx)(n.A,{maxWidth:"lg",sx:{py:4},children:(0,i.jsx)(o.A,{children:"로딩 중..."})}),(0,i.jsx)(F.A,{})]})}):(0,i.jsx)(N.A,{children:(0,i.jsxs)(r.A,{sx:{minHeight:"100vh",bgcolor:"background.default"},children:[(0,i.jsx)(D.A,{}),(0,i.jsxs)(n.A,{maxWidth:"lg",sx:{py:4},children:[(0,i.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,i.jsx)(o.A,{variant:"h4",component:"h1",children:"포스트 관리"}),(0,i.jsx)(c.A,{variant:"contained",startIcon:(0,i.jsx)(E.A,{}),onClick:()=>s.push("/write"),children:"새 포스트 작성"})]}),H&&(0,i.jsx)(a.A,{severity:"error",sx:{mb:3},children:H}),(0,i.jsx)(d.A,{sx:{mb:3},children:(0,i.jsx)(r.A,{sx:{p:2},children:(0,i.jsx)(h.A,{fullWidth:!0,placeholder:"제목, 내용으로 검색...",value:M,onChange:e=>Q(e.target.value),variant:"outlined",size:"small"})})}),(0,i.jsx)(x.A,{component:d.A,children:(0,i.jsxs)(j.A,{children:[(0,i.jsx)(A.A,{children:(0,i.jsxs)(u.A,{children:[(0,i.jsx)(p.A,{children:"제목"}),(0,i.jsx)(p.A,{children:"상태"}),(0,i.jsx)(p.A,{children:"카테고리"}),(0,i.jsx)(p.A,{children:"조회수"}),(0,i.jsx)(p.A,{children:"작성일"}),(0,i.jsx)(p.A,{children:"수정일"}),(0,i.jsx)(p.A,{children:"작업"})]})}),(0,i.jsx)(m.A,{children:t.map(e=>{var s;return(0,i.jsxs)(u.A,{children:[(0,i.jsx)(p.A,{children:(0,i.jsxs)(r.A,{children:[(0,i.jsx)(o.A,{variant:"subtitle2",noWrap:!0,children:e.title}),(0,i.jsx)(o.A,{variant:"caption",color:"text.secondary",noWrap:!0,children:e.excerpt}),e.featured&&(0,i.jsx)(g.A,{label:"추천",size:"small",color:"secondary",sx:{ml:1}})]})}),(0,i.jsx)(p.A,{children:(0,i.jsx)(g.A,{label:e.isPublished?"공개":"비공개",color:e.isPublished?"success":"default",size:"small"})}),(0,i.jsx)(p.A,{children:e.category}),(0,i.jsx)(p.A,{children:(null==(s=e.views)?void 0:s.toLocaleString())||0}),(0,i.jsx)(p.A,{children:ee(e.publishedAt)}),(0,i.jsx)(p.A,{children:ee(e.updatedAt)}),(0,i.jsx)(p.A,{children:(0,i.jsxs)(b.A,{direction:"row",spacing:1,children:[(0,i.jsx)(f.A,{size:"small",onClick:()=>Z(e),title:"보기",children:(0,i.jsx)(S.A,{})}),(0,i.jsx)(f.A,{size:"small",onClick:()=>$(e),title:"편집",children:(0,i.jsx)(P.A,{})}),(0,i.jsx)(f.A,{size:"small",onClick:()=>Y(e),title:e.isPublished?"비공개로 변경":"공개로 변경",children:e.isPublished?(0,i.jsx)(z.A,{}):(0,i.jsx)(_.A,{})}),(0,i.jsx)(f.A,{size:"small",color:"error",onClick:()=>J({open:!0,post:e}),title:"삭제",children:(0,i.jsx)(W.A,{})})]})})]},e.id)})})]})}),B>1&&(0,i.jsx)(r.A,{sx:{display:"flex",justifyContent:"center",mt:3},children:(0,i.jsx)(y.A,{count:B,page:K,onChange:(e,s)=>q(s),color:"primary"})}),(0,i.jsxs)(w.A,{open:U.open,onClose:()=>J({open:!1,post:null}),children:[(0,i.jsx)(k.A,{children:"포스트 삭제"}),(0,i.jsx)(v.A,{children:(0,i.jsxs)(o.A,{children:['"',null==(e=U.post)?void 0:e.title,'" 포스트를 정말 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.']})}),(0,i.jsxs)(C.A,{children:[(0,i.jsx)(c.A,{onClick:()=>J({open:!1,post:null}),children:"취소"}),(0,i.jsx)(c.A,{color:"error",onClick:()=>U.post&&X(U.post),children:"삭제"})]})]})]}),(0,i.jsx)(F.A,{})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[112,662,507,937,259,441,684,120],()=>s(42465)),_N_E=e.O()}]);